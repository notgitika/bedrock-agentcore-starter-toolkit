
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
      <meta name="description" content="Documentation for Amazon Bedrock AgentCore, primitives for building and running AI agents">
    
    
    
      <link rel="canonical" href="https://aws.github.io/bedrock-agentcore-starter-toolkit/user-guide/identity/quickstart-with-cli.html">
    
    
      <link rel="prev" href="quickstart.html">
    
    
      <link rel="next" href="../builtin-tools/quickstart-browser.html">
    
    
    <link rel="icon" href="../.." sizes="any">
    <link rel="icon" href="../../assets/images/favicon.png" type="image/svg+xml">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">

    
      
        <title>Identity CLI Quickstart - Amazon Bedrock AgentCore</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started-with-agentcore-identity-cli" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Amazon Bedrock AgentCore" class="md-header__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon Bedrock AgentCore
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Identity CLI Quickstart
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../index.html" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/index.html" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-tabs__link">
        
  
  
    
  
  Contribute ❤️

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api-reference/runtime.html" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Amazon Bedrock AgentCore" class="md-nav__button md-logo" aria-label="Amazon Bedrock AgentCore" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Amazon Bedrock AgentCore
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws/bedrock-agentcore-starter-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../create/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Runtime
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Runtime
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/permissions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/async.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Async Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/notebook.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtime/a2a.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime A2A Server Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Gateway
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Gateway
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gateway/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gateway Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Memory
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Memory
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Policy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Policy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" checked>
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Identity
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Identity
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Identity Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Identity CLI Quickstart
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="quickstart-with-cli.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Identity CLI Quickstart
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You'll Build
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-cognito-pools-automated" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Create Cognito Pools (Automated)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-load-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Load Environment Variables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-agent-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Create Agent Code
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-configure-agent-with-jwt-auth" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Configure Agent with JWT Auth
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-credential-provider" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Create Credential Provider
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-workload-identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Create Workload Identity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-deploy-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Deploy Agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-invoke-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Invoke the Agent
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 8: Invoke the Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-invocation-triggers-oauth-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        First Invocation (Triggers OAuth Flow)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-oauth-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete OAuth Flow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cleanup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workload-access-token-has-not-been-set" class="md-nav__link">
    <span class="md-ellipsis">
      
        “Workload access token has not been set”
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-url-not-showing-in-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authorization URL not showing in response
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-expired-or-authorization-failed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Token expired or authorization failed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#failed-to-get-token-secret_hash-was-not-received" class="md-nav__link">
    <span class="md-ellipsis">
      
        “Failed to get token: SECRET_HASH was not received”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Built-in Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Built-in Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../builtin-tools/quickstart-browser.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart Browser Tool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../builtin-tools/quickstart-code-interpreter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart Code Interpreter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/vpc-interface-endpoints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VPC Interface Endpoints
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/agentcore-vpc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AgentCore VPC Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/security-vpc-condition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VPC Condition Keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" >
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Observability
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_13" >
        
          
          <label class="md-nav__link" for="__nav_1_13" id="__nav_1_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Import Agent
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Import Agent
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Import Agent Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Import Agent Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-agent/configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Import Agent Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/agentcore-quickstart-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Transform and Deploy Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/session-management.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Session Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/async-processing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Async Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/gateway-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gateway Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/policy-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/memory_gateway_agent.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Gateway Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/runtime-framework-agents.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime Framework Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/semantic_search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/aws/bedrock-agentcore-sdk-python/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contribute ❤️
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bedrock AgentCore SDK
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bedrock AgentCore SDK
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/runtime.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtime
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/identity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Identity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/memory.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/tools.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Built-in Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Bedrock AgentCore Starter Toolkit
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bedrock AgentCore Starter Toolkit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/cli.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AgentCore CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-youll-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        What You'll Build
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-create-cognito-pools-automated" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Create Cognito Pools (Automated)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-load-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Load Environment Variables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-create-agent-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Create Agent Code
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-configure-agent-with-jwt-auth" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Configure Agent with JWT Auth
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-credential-provider" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Create Credential Provider
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-create-workload-identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Create Workload Identity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-deploy-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Deploy Agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-invoke-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Invoke the Agent
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 8: Invoke the Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-invocation-triggers-oauth-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        First Invocation (Triggers OAuth Flow)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-oauth-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete OAuth Flow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cleanup
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workload-access-token-has-not-been-set" class="md-nav__link">
    <span class="md-ellipsis">
      
        “Workload access token has not been set”
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-url-not-showing-in-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authorization URL not showing in response
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-expired-or-authorization-failed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Token expired or authorization failed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#failed-to-get-token-secret_hash-was-not-received" class="md-nav__link">
    <span class="md-ellipsis">
      
        “Failed to get token: SECRET_HASH was not received”
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="getting-started-with-agentcore-identity-cli">Getting Started with AgentCore Identity (CLI)<a class="headerlink" href="#getting-started-with-agentcore-identity-cli" title="Permanent link">&para;</a></h1>
<p>Amazon Bedrock AgentCore Identity provides secure OAuth 2.0 authentication for your AI agents. This quickstart demonstrates how to build an agent that authenticates users and accesses external services using the AgentCore CLI.</p>
<h2 id="what-youll-build">What You'll Build<a class="headerlink" href="#what-youll-build" title="Permanent link">&para;</a></h2>
<p>A simple agent that:
1. Accepts JWT bearer tokens for user authentication (inbound auth)
2. Obtains OAuth tokens to call external services on behalf of users (outbound auth)
3. Demonstrates the complete OAuth flow with user consent</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>AWS account with appropriate permissions</li>
<li>Python 3.10+ installed</li>
<li>AWS CLI configured (<code>aws configure</code>)</li>
<li>bedrock-agentcore-starter-toolkit installed</li>
</ul>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Create project directory</span>
mkdir<span class="w"> </span>agentcore-identity-demo
<span class="nb">cd</span><span class="w"> </span>agentcore-identity-demo

<span class="c1"># Create virtual environment</span>
python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate

<span class="c1"># Install dependencies</span>
pip<span class="w"> </span>install<span class="w"> </span>bedrock-agentcore<span class="w"> </span>bedrock-agentcore-starter-toolkit<span class="w"> </span>strands-agents<span class="w"> </span>boto3
</code></pre></div>
<h2 id="step-1-create-cognito-pools-automated">Step 1: Create Cognito Pools (Automated)<a class="headerlink" href="#step-1-create-cognito-pools-automated" title="Permanent link">&para;</a></h2>
<p>The <code>setup-cognito</code> command creates both Cognito pools needed for Identity in one step:</p>
<div class="highlight"><pre><span></span><code>agentcore<span class="w"> </span>identity<span class="w"> </span>setup-cognito
</code></pre></div>
<p><strong>What this creates:</strong></p>
<ul>
<li><strong>Cognito Agent User Pool</strong>: Manages user authentication to your agent</li>
<li><strong>Cognito Resource User Pool</strong>: Enables agent to access external resources</li>
<li>Test users with credentials for both pools</li>
<li>Environment variables file for easy access</li>
</ul>
<p><strong>Output shows:</strong></p>
<div class="highlight"><pre><span></span><code>✅ Cognito pools created successfully!

🔐 Credentials saved securely to:
   • .agentcore_identity_cognito_user.json
   • .agentcore_identity_user.env
</code></pre></div>
<h2 id="step-2-load-environment-variables">Step 2: Load Environment Variables<a class="headerlink" href="#step-2-load-environment-variables" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Bash/Zsh (for USER flow)</span>
<span class="nb">export</span><span class="w"> </span><span class="k">$(</span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;^#&#39;</span><span class="w"> </span>.agentcore_identity_user.env<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="k">)</span>

<span class="c1"># Verify variables are loaded</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$RUNTIME_POOL_ID</span>
<span class="nb">echo</span><span class="w"> </span><span class="nv">$IDENTITY_CLIENT_ID</span>
</code></pre></div>
<p><strong>Available variables (USER flow):</strong></p>
<ul>
<li><code>RUNTIME_POOL_ID</code>, <code>RUNTIME_CLIENT_ID</code>, <code>RUNTIME_DISCOVERY_URL</code></li>
<li><code>RUNTIME_USERNAME</code>, <code>RUNTIME_PASSWORD</code></li>
<li><code>IDENTITY_POOL_ID</code>, <code>IDENTITY_CLIENT_ID</code>, <code>IDENTITY_CLIENT_SECRET</code></li>
<li><code>IDENTITY_DISCOVERY_URL</code>, <code>IDENTITY_USERNAME</code>, <code>IDENTITY_PASSWORD</code></li>
</ul>
<h2 id="step-3-create-agent-code">Step 3: Create Agent Code<a class="headerlink" href="#step-3-create-agent-code" title="Permanent link">&para;</a></h2>
<p>Create <code>agent.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;AgentCore Identity Quickstart: Inbound + Outbound Authentication&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">strands</span><span class="w"> </span><span class="kn">import</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">tool</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore.runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">BedrockAgentCoreApp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bedrock_agentcore.identity.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">requires_access_token</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">BedrockAgentCoreApp</span><span class="p">()</span>

<span class="n">MODEL_ID</span> <span class="o">=</span> <span class="s2">&quot;us.anthropic.claude-sonnet-4-5-20250929-v1:0&quot;</span>

<span class="c1"># Store authorization URL to return to user</span>
<span class="n">auth_url_holder</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;needs_auth&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<span class="nd">@requires_access_token</span><span class="p">(</span>
    <span class="n">provider_name</span><span class="o">=</span><span class="s2">&quot;ExternalServiceProvider&quot;</span><span class="p">,</span>
    <span class="n">scopes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;openid&quot;</span><span class="p">],</span>
    <span class="n">auth_flow</span><span class="o">=</span><span class="s2">&quot;USER_FEDERATION&quot;</span><span class="p">,</span>
    <span class="n">on_auth_url</span><span class="o">=</span><span class="k">lambda</span> <span class="n">url</span><span class="p">:</span> <span class="n">auth_url_holder</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="s2">&quot;needs_auth&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}),</span>
    <span class="n">force_authentication</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_identity_token</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">access_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get OAuth token from Identity service&quot;&quot;&quot;</span>
    <span class="n">auth_url_holder</span><span class="p">[</span><span class="s2">&quot;needs_auth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">access_token</span>

<span class="nd">@tool</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">check_external_service</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check authentication to external services via Identity OAuth.&quot;&quot;&quot;</span>
    <span class="c1"># Reset state</span>
    <span class="n">auth_url_holder</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">auth_url_holder</span><span class="p">[</span><span class="s2">&quot;needs_auth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Start token request with short timeout</span>
        <span class="n">token_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">get_identity_token</span><span class="p">())</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Check if authorization is needed</span>
        <span class="k">if</span> <span class="n">auth_url_holder</span><span class="p">[</span><span class="s2">&quot;needs_auth&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">auth_url_holder</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]:</span>
            <span class="n">token_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">token_task</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;🔐 Authorization Required</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Please open this URL in your browser to authorize:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">auth_url_holder</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;After authorizing, call this tool again with the same session ID.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Token obtained</span>
        <span class="n">token</span> <span class="o">=</span> <span class="k">await</span> <span class="n">token_task</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;✅ Authenticated to external service</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Token length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span><span class="si">}</span><span class="s2"> characters</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Status: Active and cached for this session&quot;</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;❌ Failed to authenticate: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">entrypoint</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entrypoint&quot;&quot;&quot;</span>
    <span class="n">user_message</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prompt&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">MODEL_ID</span><span class="p">,</span>
        <span class="n">system_prompt</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;You are a helpful assistant with access to external services via OAuth.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;When check_external_service returns an authorization URL, &quot;</span>
            <span class="s2">&quot;present it clearly to the user and ask them to authorize.&quot;</span>
        <span class="p">),</span>
        <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">check_external_service</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">invoke_async</span><span class="p">(</span><span class="n">user_message</span><span class="p">)</span>
    <span class="n">response_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="p">[{}])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">response_text</span><span class="p">}</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p>Create <code>requirements.txt</code>:</p>
<div class="highlight"><pre><span></span><code>bedrock-agentcore
bedrock-agentcore-starter-toolkit
strands-agents
boto3
</code></pre></div>
<h2 id="step-4-configure-agent-with-jwt-auth">Step 4: Configure Agent with JWT Auth<a class="headerlink" href="#step-4-configure-agent-with-jwt-auth" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>agentcore<span class="w"> </span>configure<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span>agent.py<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>identity_demo<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--authorizer-config<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">    &quot;customJWTAuthorizer&quot;: {</span>
<span class="s1">      &quot;discoveryUrl&quot;: &quot;&#39;</span><span class="nv">$RUNTIME_DISCOVERY_URL</span><span class="s1">&#39;&quot;,</span>
<span class="s1">      &quot;allowedClients&quot;: [&quot;&#39;</span><span class="nv">$RUNTIME_CLIENT_ID</span><span class="s1">&#39;&quot;]</span>
<span class="s1">    }</span>
<span class="s1">  }&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--disable-memory
</code></pre></div>
<p><strong>What this does:</strong></p>
<ul>
<li>Configures agent with JWT authentication using Cognito Agent User Pool</li>
<li>Creates execution role (or uses provided one)</li>
<li>Saves configuration to <code>.bedrock_agentcore.yaml</code></li>
</ul>
<h2 id="step-5-create-credential-provider">Step 5: Create Credential Provider<a class="headerlink" href="#step-5-create-credential-provider" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>agentcore<span class="w"> </span>identity<span class="w"> </span>create-credential-provider<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>ExternalServiceProvider<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--type<span class="w"> </span>cognito<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--client-id<span class="w"> </span><span class="nv">$IDENTITY_CLIENT_ID</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--client-secret<span class="w"> </span><span class="nv">$IDENTITY_CLIENT_SECRET</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--discovery-url<span class="w"> </span><span class="nv">$IDENTITY_DISCOVERY_URL</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cognito-pool-id<span class="w"> </span><span class="nv">$IDENTITY_POOL_ID</span>
</code></pre></div>
<p><strong>What this does:</strong></p>
<ul>
<li>Creates OAuth credential provider in Identity service</li>
<li>Saves provider configuration to <code>.bedrock_agentcore.yaml</code></li>
<li>IAM permissions will be added automatically during <code>deploy</code></li>
</ul>
<h2 id="step-6-create-workload-identity">Step 6: Create Workload Identity<a class="headerlink" href="#step-6-create-workload-identity" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>agentcore<span class="w"> </span>identity<span class="w"> </span>create-workload-identity<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>identity-demo-workload
</code></pre></div>
<p><strong>What this does:</strong></p>
<ul>
<li>Creates workload identity for agent-to-Identity authentication</li>
<li>Enables OAuth flows for external service access</li>
</ul>
<h2 id="step-7-deploy-agent">Step 7: Deploy Agent<a class="headerlink" href="#step-7-deploy-agent" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>agentcore<span class="w"> </span>deploy
</code></pre></div>
<p><strong>What happens during launch:</strong></p>
<ul>
<li>Agent container built and pushed to ECR</li>
<li>Runtime instance created</li>
<li><strong>IAM permissions automatically added</strong> for Identity:</li>
<li>Trust policy updated</li>
<li>GetWorkloadAccessToken permissions</li>
<li>GetResourceOauth2Token permissions</li>
<li>Secrets Manager access for credential provider</li>
<li>Agent endpoint created</li>
</ul>
<p><strong>Look for this in the output:</strong></p>
<div class="highlight"><pre><span></span><code>✅ Identity permissions added automatically
   Providers: ExternalServiceProvider
</code></pre></div>
<h2 id="step-8-invoke-the-agent">Step 8: Invoke the Agent<a class="headerlink" href="#step-8-invoke-the-agent" title="Permanent link">&para;</a></h2>
<h3 id="first-invocation-triggers-oauth-flow">First Invocation (Triggers OAuth Flow)<a class="headerlink" href="#first-invocation-triggers-oauth-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Get bearer token for Runtime authentication (auto-loads from env)</span>
<span class="nv">BEARER_TOKEN</span><span class="o">=</span><span class="k">$(</span>agentcore<span class="w"> </span>identity<span class="w"> </span>get-cognito-inbound-token<span class="k">)</span>

<span class="c1"># Invoke agent</span>
agentcore<span class="w"> </span>invoke<span class="w"> </span><span class="s1">&#39;{&quot;prompt&quot;: &quot;Call the external service&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--bearer-token<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BEARER_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--session-id<span class="w"> </span><span class="s2">&quot;demo_session_</span><span class="k">$(</span>uuidgen<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
<p><strong>Expected Response:</strong></p>
<div class="highlight"><pre><span></span><code>🔐 Authorization Required

To access the external service, please authorize:
https://bedrock-agentcore.us-west-2.amazonaws.com/identities/oauth2/authorize?request_uri=...

Login with Resource User Pool credentials:
Username: externaluser12345678
Password: Abc123...

After authorizing, invoke again with the same session ID.
</code></pre></div>
<h3 id="complete-oauth-flow">Complete OAuth Flow<a class="headerlink" href="#complete-oauth-flow" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Copy the authorization URL</strong> from the response</li>
<li><strong>Open in browser</strong></li>
<li><strong>Login</strong> with Resource User Pool credentials (IDENTITY_USERNAME/IDENTITY_PASSWORD from env vars)</li>
<li><strong>Approve</strong> the consent screen</li>
<li><strong>Invoke again</strong> with the <strong>same session ID</strong>:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># Use the SAME session ID as before!</span>
agentcore<span class="w"> </span>invoke<span class="w"> </span><span class="s1">&#39;{&quot;prompt&quot;: &quot;Call the external service&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--bearer-token<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BEARER_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--session-id<span class="w"> </span><span class="s2">&quot;demo_session_</span><span class="k">$(</span>uuidgen<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
<p><strong>Expected Response:</strong></p>
<div class="highlight"><pre><span></span><code>✅ External Service Response

Successfully called external service!
Token obtained and cached for this session.
Token length: 1234 characters

Subsequent calls in this session will use the cached token.
</code></pre></div>
<h2 id="cleanup">Cleanup<a class="headerlink" href="#cleanup" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Delete all Identity resources</span>
agentcore<span class="w"> </span>identity<span class="w"> </span>cleanup<span class="w"> </span>--agent<span class="w"> </span>identity_demo<span class="w"> </span>--force

<span class="c1"># Destroy agent</span>
agentcore<span class="w"> </span>destroy<span class="w"> </span>--agent<span class="w"> </span>identity_demo<span class="w"> </span>--force
</code></pre></div>
<p><strong>What gets cleaned up:</strong></p>
<ul>
<li>Credential provider (ExternalServiceProvider)</li>
<li>Workload identity (identity-demo-workload)</li>
<li>Both Cognito user pools</li>
<li>IAM inline policies</li>
<li>Configuration files (.agentcore_identity_*)</li>
</ul>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="workload-access-token-has-not-been-set">“Workload access token has not been set”<a class="headerlink" href="#workload-access-token-has-not-been-set" title="Permanent link">&para;</a></h3>
<p><strong>Cause</strong>: Using <code>agent(message)</code> instead of <code>await agent.invoke_async(message)</code></p>
<p><strong>Fix</strong>: Update your entrypoint to use <code>invoke_async</code></p>
<h3 id="authorization-url-not-showing-in-response">Authorization URL not showing in response<a class="headerlink" href="#authorization-url-not-showing-in-response" title="Permanent link">&para;</a></h3>
<p><strong>Cause</strong>: <code>on_auth_url</code> callback using <code>print()</code> which goes to logs</p>
<p><strong>Fix</strong>: Use the pattern shown in this guide with <code>auth_url_holder</code></p>
<h3 id="token-expired-or-authorization-failed">Token expired or authorization failed<a class="headerlink" href="#token-expired-or-authorization-failed" title="Permanent link">&para;</a></h3>
<p><strong>Solution</strong>: Use a new session ID and start the OAuth flow again</p>
<h3 id="failed-to-get-token-secret_hash-was-not-received">“Failed to get token: SECRET_HASH was not received”<a class="headerlink" href="#failed-to-get-token-secret_hash-was-not-received" title="Permanent link">&para;</a></h3>
<p><strong>Cause</strong>: Cognito client configured with secret but using password auth</p>
<p><strong>Fix</strong>: Run <code>agentcore identity setup-cognito</code> again</p>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li>Add multiple credential providers for different external services</li>
<li>Implement M2M (machine-to-machine) OAuth flows</li>
<li>Build production agents with Memory and Code Interpreter</li>
<li>Explore VPC networking for secure service access</li>
</ul>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>You’ve built an agent with:</p>
<ul>
<li>✅ Automated Cognito pool setup</li>
<li>✅ JWT authentication for user access</li>
<li>✅ OAuth 2.0 flows for external service calls</li>
<li>✅ Automatic IAM permission management</li>
<li>✅ Token caching per session</li>
<li>✅ Secure credential storage</li>
<li>✅ One-command cleanup</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>